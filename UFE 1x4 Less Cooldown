-- Made by WolfIk8

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local TextService = game:GetService("TextService")

-- Player and GUI
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local frame = playerGui:WaitForChild("CoreHud"):WaitForChild("1x4")

-- Configuration
local buttonConfigs = {
    {
        Name = "Slash",
        Key = Enum.UserInputType.MouseButton1,
        KeyName = "LMB",
        RemoteEvent = ReplicatedStorage.PleaseStopSkiddingMyCharacterEvents["1x4"]:WaitForChild("1x4AttackRemote"),
        Animations = {
            ["TheSaladAppears"]="rbxassetid://92428176677523",
            ["Hacklord"]="rbxassetid://131561320564067",
            ["Default"]="rbxassetid://95091028013279"
        },
        Cooldown = 0.5
    },
    {
        Name = "MassInfection",
        Key = Enum.KeyCode.Q,
        KeyName = "Q",
        RemoteEvent = ReplicatedStorage.PleaseStopSkiddingMyCharacterEvents["1x4"]:WaitForChild("MassInfection"),
        Animations = nil,
        Cooldown = 3
    },
    {
        Name = "Entanglement",
        Key = Enum.KeyCode.E,
        KeyName = "E",
        RemoteEvent = ReplicatedStorage.PleaseStopSkiddingMyCharacterEvents["1x4"]:WaitForChild("Entanglement"),
        Animations = nil,
        Cooldown = 3
    },
    {
        Name = "UnstableEye",
        Key = Enum.KeyCode.R,
        KeyName = "R",
        RemoteEvent = ReplicatedStorage.PleaseStopSkiddingMyCharacterEvents["1x4"]:WaitForChild("UnstableEye"),
        Animations = nil,
        Cooldown = 3
    }
}

-- Old Buttons Data
local oldButtonsData = {}
for _, cfg in ipairs(buttonConfigs) do
    local oldBtn = frame:FindFirstChild(cfg.Name)
    if oldBtn and oldBtn:IsA("ImageButton") then
        oldButtonsData[cfg.Name] = {
            Position = oldBtn.AbsolutePosition,
            Size = oldBtn.AbsoluteSize
        }
    end
end

-- Remove Old Buttons
for _, oldBtn in ipairs(frame:GetChildren()) do
    if oldBtn:IsA("ImageButton") and table.find({"Slash","MassInfection","Entanglement","UnstableEye"}, oldBtn.Name) then
        oldBtn:Destroy()
    end
end

-- Functions
local function adjustFont(label, maxSize, minSize)
    local text = label.Text
    local labelWidth = label.AbsoluteSize.X
    local labelHeight = label.AbsoluteSize.Y
    local size = maxSize
    while size >= minSize do
        local textSize = TextService:GetTextSize(text, size, label.Font, Vector2.new(10000,10000))
        if textSize.X <= labelWidth and textSize.Y <= labelHeight then break end
        size = size - 1
    end
    label.TextSize = size
end

-- GUI Creation
for _, cfg in ipairs(buttonConfigs) do
    local data = oldButtonsData[cfg.Name]
    if data then
        local btn = Instance.new("TextButton")
        btn.Name = cfg.Name
        btn.BackgroundColor3 = Color3.new(0,0,0)
        btn.BackgroundTransparency = 0.5
        btn.Text = ""
        btn.BorderSizePixel = 1
        btn.BorderColor3 = Color3.new(0,0,0)

        local parentSize = frame.AbsoluteSize
        local scaleX = data.Position.X / parentSize.X
        local scaleY = data.Position.Y / parentSize.Y
        local sizeX = data.Size.X / parentSize.X
        local sizeY = data.Size.Y / parentSize.Y

        btn.Position = UDim2.new(scaleX,0,scaleY,0)
        btn.Size = UDim2.new(sizeX,0,sizeY,0)
        btn.Parent = frame

        -- Text Labels
        local tKey = Instance.new("TextLabel", btn)
        tKey.Size = UDim2.new(1,0,0.33,0)
        tKey.Position = UDim2.new(0,0,0,0)
        tKey.Text = cfg.KeyName
        tKey.BackgroundTransparency = 1
        tKey.TextColor3 = Color3.new(1,1,1)
        tKey.Font = Enum.Font.Gotham
        tKey:GetPropertyChangedSignal("AbsoluteSize"):Connect(function()
            adjustFont(tKey, 14, 8)
        end)

        local tTimer = Instance.new("TextLabel", btn)
        tTimer.Size = UDim2.new(1,0,0.33,0)
        tTimer.Position = UDim2.new(0,0,0.33,0)
        tTimer.Text = ""
        tTimer.BackgroundTransparency = 1
        tTimer.TextColor3 = Color3.new(1,1,1)
        tTimer.Font = Enum.Font.Gotham
        tTimer:GetPropertyChangedSignal("AbsoluteSize"):Connect(function()
            adjustFont(tTimer, 28, 16)
        end)

        local tName = Instance.new("TextLabel", btn)
        tName.Size = UDim2.new(1,0,0.34,0)
        tName.Position = UDim2.new(0,0,0.66,0)
        tName.Text = cfg.Name
        tName.BackgroundTransparency = 1
        tName.TextColor3 = Color3.new(1,1,1)
        tName.Font = Enum.Font.Gotham
        tName:GetPropertyChangedSignal("AbsoluteSize"):Connect(function()
            adjustFont(tName, 11, 5)
        end)

        -- Button Functionality
        local canClick = true
        local animTracks = {}

        local function updateAnimations()
            local char = player.Character
            if not char then return end
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            if not humanoid then return end
            animTracks = {}
            if cfg.Animations then
                for key, animId in pairs(cfg.Animations) do
                    local animation = Instance.new("Animation")
                    animation.AnimationId = animId
                    animTracks[key] = humanoid:LoadAnimation(animation)
                    animTracks[key].Looped = false
                end
            end
        end

        player.CharacterAdded:Connect(updateAnimations)
        if player.Character then
            updateAnimations()
        end

        -- Activation
        local function activate()
            if not canClick then return end
            local char = player.Character
            if not char or char:GetAttribute("Character") ~= "1x4" or char.Humanoid.Health <= 0 then return end
            canClick = false
            if animTracks["Default"] then animTracks["Default"]:Play() end
            cfg.RemoteEvent:FireServer()

            tTimer.Text = tostring(cfg.Cooldown)
            task.spawn(function()
                for t = cfg.Cooldown*10,1,-1 do
                    tTimer.Text = string.format("%.1f", t/10)
                    task.wait(0.1)
                end
                tTimer.Text = ""
                canClick = true
            end)
        end

        btn.Activated:Connect(activate)
        UserInputService.InputBegan:Connect(function(input, processed)
            if processed then return end
            if input.UserInputType == cfg.Key or input.KeyCode == cfg.Key then
                activate()
            end
        end)
    end
end
